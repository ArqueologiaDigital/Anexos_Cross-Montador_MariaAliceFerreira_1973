// FOR
*ONE WORD INTEGERS
*LIST SOURCE PROGRAM
*IOCS(CARD,1403PRINTER,DISK)
C     PRIMEIRA PARTE
C     *****************************************************************
C    *              MONTA A TABELA DE SIMBOLOS.
C    *              DESCOBRE O MNEMONICO
C    *              MONTA TABELAS ASSOCIADAS
C    ******************************************************************
C     INMNE - INDICADOR DE MNEMONICO
C           = 1 - MNEMONICO
C           = 2 - PSEUDO
C           = 3 - MACRO
C           = 4 - FIM
C           = 5 - COMENTARIO
C           = 6 - ERR0
C     ICK - INDICADOR DE ABSOLUTO OU RELOCAVEL
      DEFINE FILE   9(400,80,U,N5)
      DEFINE FILE 6(100,80,U,N6)
      DEFINE FILE 7(30,80,U,N7)
      DEFINE FILE 8(4800,1,U,NR)
      REAL IFPX(50)
      DIMENSION ISTRP(80),MAT(4)
      COMMON IPAG,KONT,IPRIN,ICAB(37),ID5,ID6,ID7,N5,N6,N7
      COMMON IAPSI,IAPEQ,NOEQU(100),NOSIM(400,5),IENSI(400)
      COMMON IORIG,ISTRT,ICNT,LST,ISWER
      COMMON NUM(16),INIC(62),ICOL(320),ISTEC(90),IAPTC
      COMMON IS,IERR,IAPER,IERRA(80),IND,IAPIN,IRET,IAC,ICOMP
      COMMON IABS,IPENT,KERRR
      EQUIVALENCE (IIS,INIC(4))
      EQUIVALENCE (ICONT,IERR),(1BCO,INIC(38)),(IESTR,INIC(45))
      EQUIVALENCE (ISTRP(1),ISTEC(1)),(IPONT,INIC(1)),(IPAUT,INIC(44))
      EQUIVALENCE (ICNT,KR),(IENTR,LST),(IAC,NSTAT,NS)
      DATA IBAR /*/*/
      DATA ICARD,MK,ISTEP,ICK /2,1,2*0/
      DATA IKCRD/O/
C
C     INICIALTZACAO
C
      KR=0
      IENTR=0
      IFP=0
      IABS=0
      CALL WZ1
C
C     COMECA O PROCESSAMENTO
C
      NF=1
  200 READ(ICARD,10)(ICOL(I),I=1,80)
   10 FORMAT(80A1)
      IKCRD=IKCRD+1
C
C
      WRITE(ID5'N5)( ICOL(I),I=1,80)
C
C
  209 IF(ICOL(21)-IESTR) 210,4300,210
  210 IF(ICOL(21)-IBCO)220,310,220
C
C     A INSTRUCAO CONTEM LABEL
C
  220 L1=21
      CALL WZTRZ(L1,L2,1,ISW1,M)
      IF(M)230,280,230
C
C     OCORREU ERRO
C
  230 L1 = 0
  280 I=L2+2
      GO TO 320
C
C     INSTRUCAO SEM LABEL
C
  310 I=22
      L1 = 0
C
C     VERIFICA SE O LABEL E SEGUIDO DE BRANCOS
C
  320 IF(I-27) 330,410,410
  330 DO 400 K=I,26
      IF(ICOL(K)-IBC0)405,400,405
  400 CONTINUE
C
C     VERIFICA BRANCOS SEGUINGO  O CODIGO
C
  410 JIND=0
      IF(ICOL(31)-IBC0) 510,507,510
  507 IF(ICOL(33)-IBC0) 510,508,510
  508 IF(ICOL(34)-IBC0) 510,509,510
  509 IF(ICOL(32)-IIS ) 512,511,512
  512 IF(ICOL(32)-IBCO) 510,520,510
  511 JIND=1
      ISTEP=ISTEP+1
C
C     BUSCA DO MNEMONICO
C     ESCOLHE A ROTINA ESPECIFICA
C
  520 CALL WZMN(IK,L1,L2,ISTEP,IFP,IFPX)
      INMNE=ISTEC(IAPTC+1)
      IOPTG=ISTEC(IAPTC+3)
      GO TO (2000,750,9000,2000,2000,841),INMNE
C
C     ERRO
C
  840 ISTEC(IAPTC+1)=6
  841 LW=2
      GO TO 6900
C
C     COMENTARIO
C
 4300 ISTEC(IAPTC+1)=5
      IKCRD=IKCRD-1
      LW=2
      GO TO 6900
C
C
C     INSTRUCOES COM OPERANDOS SIMBOLICOS
C
 1200 CALL WZOPE(ISTEP,JIND)
      JIND=0
      ISTEP=ISTEP+2
      GO TO 4200
C     TESTE DE EXISTENCIA DE OPERANDO PARA MNEMONICO
C
 2000 IF(ICOL(IOPTG)-IBCO) 2010,2020,2010
 2010 GO TO (2050,2050,2050,2060,2050,2050,2050,2050,2060,2050),IK
 2020 GO TO (2070,2070,2050,2050,2070,2070,2070,2070,2050,2070),IK
 2050 GO TO (1200,845,845,2100,1200,2100,2100,845,845,2100),IK
C
C     INCREMENTA CI DE 1 - INSTRUCAO CURTA
C
 2100 ISTEP = ISTEP + 1
      ISTEC(IAPTC+4)=1
      GO TO 846
C     INCREMENTA CI DE 2 - INSTRUCAO LONGA
C
  845 ISTEP = ISTEP+2
      ISTEC(ITAPTC+4)=2
  846 ISTEC(IAPTC)=IAPTC+5
      IF(JIND) 2105,855,2105
 4200 CONTINUE
C
C     VERITFICA SE VETOR DE INFORMACAO SUPLEMENTAR ESTA CCMPLETO
C
      IF(IAPTC-80) 4211,4211,4220
 4211 NF=IAPTC
      GO TO 4210
 4220 ISTEC(NF)=IAPTC-80
      WRITE(ID6'N6) ISTRP
      DO 4221 I=81,IAPTC
 4221 ISTEC(I-80)=ISTEC(I)
      IAPTC=IAPTC-80
      NF=IAPTC
 4210 CALL WZWPT(IPAUT)
      GO TO (200,8000),MK
C
C     PSEUDO FOI ENCONTRADA
C
  750 IENMN=ISTEC(IAPTC+2)
      GO TO(760,760,760,760,770,770,770,770,770,770,760,760,751,760,760,
     1      770,760,760,760,760,760,760,751,751) ,  IENMN
C
C    DESVIO A ROTINA DE TRATAMENTO DA PSEUDO
C
  751 GO TO (3200,3000,845,5100,6199,6199,6199,6199,6199,6199,3300,3100,
     1     3800,3400,3600,6500,5000,5500,6199,5500,5620,7100),IK
C
C     TESTES DE OPERANDOS PARA PSEUDOS
C
  760 IF(ICOL(IOPTG)-IBCO)751,761,751
  776 IF(L1)777,845,777
  777  CALL WZPRC(1,K,ISTEP,L1,L2)
      NOSIM(K,4)=1
      GO TO 845
  770 IF(ICOL(IOPTG)-IBCO)761,751,761
C
C     TRATA DA PSEUDO 'BLOCO'
C
 3000 CALL WZCNV(IOPTG-1,N,K1,K2,1,M,38)
      LW=5
      IF(M)6800,3010,6800
 3010 IF(L1)3030,3050,3030
 3030 CALL WZPRC (1,LK,ISTEP,L1,L2)
      NOSIM(LK,5)=N
      IF(NOSIM(LK+4)) 3050,3040,3050
 3040 NOSIM(LK,4)=4
 3050 ISTEP=ISTEP+N
      ISTEC(IAPTC+4)=N
      GO TO 6800
C
C     TRATA DA PSEUDO EQUIVALENCE
C
 3100 LW=4
      IF(L1) 3110,3305,3110
 3110 CALL WZEQU(L1,L2,ISTEP)
      GO TO 6800
C
C     TRATA DA PSEUDO DE DEFINICAO
C
 3200 CALL WZCNT(L1,L2,ISTEP)
      LW=6
      ISTEP=ISTEP+1
      GO TO 6800
C
C     TRATA DA PSEUDO COMMON
C     NO CASO DA PSEUDO COMMON A ROTINA DETERMINA O NUMERO DE POSICOES
C     A SEREM USADAS. SE A INSTRUCAO NAO CONTIVER TAL NUMERO, O NOME
C     NAO E INSERIOO NA TABELA.
 3300 LW=4
      IF(L1)3310,3305,3310
 3310 CALL WZPRC(1,K,ISTEP,L1,L2)
      CALL WZCNV(IOPTG-1,N,K1,K2,1,M,38)
      NOSIM(K,5)=N
      IF(M) 4200,3330,4200
 3330 IF(NOSIM(K,4)) 6800,3331,6800
 3331 NOSIM(K,4)=3
      GO TO 6800
C
C     TRATA DA PSEUDO 'ORG'
C
 3400 ICK=1
      IABS=1
      IF(ICOL(IOPTG)-IBAR) 3401,3433,3401
 3401 CALL WZCNV(LOPTG—1,N,K1,K2,1,M,38)
 3402 LW=6
      IF(M) 6200,3440,6200
 3433 CALL WZCNV(IOPTG,N,K1,K2,0,M,38)
      GO TO 3402
 3440 IF(N-4096) 3450,3470,3470
 3450 ISTEP=N
      ISTEC(IAPTC+4)=N
 3460 GO TO 6201
C
C     TRATA DA PSEUDO ENTRY
C
 3600 CALL WZENT(KR,IENTR,NSTAT)
      LW=4
      GO TO 6200
C
C     TRATA DA PSEUDO ISS
C
 5000 CALL WZISS(IKCRD)
      LW=4
      GO TO 6200
C
C     TRATA DA PSEUDO DEFEN
C     EQUIVALE A 'PLA'
C
 5100 IF(JIND) 5102,5101,5102
 5101 ISTEC(IAPTC+1)=1
      ISTEC(IAPTC+2)=20
      IF(L1)5105,5107,5105
 5105 CALL WZPRC(1,K,ISTEP,1,L1,L2)
      IF(NOSIM(K,4)) 5107,5106,5107
 5106 NOSIM(K,4)=1
      GO TO 5107
 5107 IK=1
      GO TO 2000
C
C     DEFINE NOME
C
 5620 CALL WZTRZ(IOPTG,IFIM,ISW,ISW1,M)
      LW=4
      IF(M) 6200,5630,6200
 5630 CALL WZPRC(1,K,ISTEP,IOPTG,IFIM)
      IF(NOSIM(K,4))6200,5631,6200
 5631 NOSIM(K,4)=7
      GO TO 6200
C
C     PSEUDO EBC
C
 5500 IF(ICOL(IOPTG)-IPONT ) 5510,5520,5510
 5520 IOPTG=IOPTG+1
      K=IOPTG
      DO 5530 J=1,36
      JJ=73-J
      IF(ICOL(JJ  )-INIC(1))5530,5540,5530
 5530 CONTINUE
      GO TO 5510
 5540 J=37-J
      ISTEC(IAPTC+4)=1
      ISTEC(IAPTC+5)=J
      LW=6
      ISTEP=ISTEP+J
      IF(L1)5441,6800,5441
 5441 CALL WZPRC(1,LK,ISTEP,L1,L2)
      IF(NOSIM(LK,4)) 6800,5542,6800
 5542 NOSIM(LK,4)=1
      GO TO 6800
C
C     TRATA DA PSEUDO 'END'
C
 3800 ISTEC(IAPTC+1)=4
      LW=2
      IF(NS) 3801,3802,3801
 3802 IF(KR) 3801,3880,3801
 3880 IF(ICOL(35)-IBCO)  3881,208,3881
 3881 L3=35
      CALL WZTRZ(L3,L2,1,ISW1,M)
      IF(M) 3870,3882,3870
 3882 CALL WZPRC(2,K,ISTEP,L3,L2)
      KK=NOSIM(K,4)+1
      GO T0(208,3884,3884,208,208,208,208,208,3884,3884,208),KK
 3884 IPENT=IENSI(K)
      GO TO 3801
 3801 IF (L1)  3860,3870,3860
 3870 MK=2
      GO TO 6800
C
C     EXTERNAL
C
 7100 IF(ICOL(35)-IBCO)7101,7135,7101
 7101 L3=35
      CALL WZTRZ(L3,L2,1,ISW1,M)
      IF(M)7119,7103,7119
 7103 IF(L2-L3-3)7106,7106,7135
 7106 CALL WZPRC(2,K,ISTEP,L3,L2)
      IF(NOSIM(K,4))7135,7109,7135
 7109 IF(K-IAPS1)7135,7112,7135
 7112 IAPSI=IAPSI-1
      DO 7114 I1=1,4
 7114 MAT(II)=IBCO
      IT=1
      DO 7117 II=L3,L2
      MAT(IT)=ICOL(II)
 7117 IT=IT+1
      CALL WZCMP(F,MAT(1),MAT(2),MAT(3),MAT(4))
      IFP=TFP+1
      IFPX(IFP)=F
 7119 GO TO 6200
 7135 CALL WZERR(18)
      GO TO 6200
C
C     TESTE DE LABEL
C
 6199 IKCRD=IKCRD-1
 6200 LW=4
 6201 IF(L1) 6205,6800,6205
C
C     PSEUDCG ABS
C
 6500 IF(IKCRD-1) 3405,6505,3405
 6505 ICK=1
      IABS=1
      LW=4
      GO TO 6201
C
C
C
 6800 IF(JIND) 6805,6900,6805
 6900 ISTEC(IAPTC)=IAPTC+LW
      IAPTC=IAPTC+LW
      GO TO 4200
C
 8000 CALL WZWPT(IPAUT)
      WRITE (ID6'N6)   ISTRP
      IORIG=ICK
      INREL=0
C
C     FINALIZACAO DA PRIMEIRA FASE
C
      IF(IERR )100,201,100
  100 M=O
      GO TO 250
C
C     NAO OCORRERAM ERROS NA PRIMEIRA FASE ATE A FINALIZACAO
C     TERMINA PREPARO DA TABELA DE SIMBOLOS
C
  201 CONTINUE
      IAPER=IAPER-1
      CALL WZEND(IERR)
      CALL WZWPT(IPAUT)
C
C     VERIFICA SE OCORRERAM ERROS NO PREPARO FINAL DA TABELA DE SIMBOLOS
C
      IF(IERR ) 100,231,100
  231 CALL WZTES(N)
      ISTRT=ISTEP
      M=1
C
C     VERIFICA DEFINICAO DOS SIMBOLOS DA TABELA DE SIMBOLOS
C
      IF(N)250,900,250
  250 IERRA(1)=IAPER-1
      WRITE(ID7'N7) IERRA
      CALL WZLIS(INREL,ISTEP)
      IF(M—1) 899,257,899
  257 CALL WZRSL
  899 WRITE(IPRIN,110) IERR
  110 FORMAT(1HO,1LOX,'TOTAL DE ERROS NO PROGRAMA = ',I4,/,11X,
     1      'PROGRAMA DESCONTINUADO')
C
C
C
      CALL EXIT

  900 CALL LINK(WZGER)
C
C
C
 9000 ISTEC(IAPTC+1)=2
      ISTEC(IAPTC+2)=3
      IK=3
      ISTEC(IAPTC+3)=27
      GO TO 845
C
C     TRATAMENTO DOS ERROS
C
  208 CALL WZERR(20)
      GO 10 3801
  405 CALL WZERR(3)
      GO TO 840
  510 CALL WZERR(5)
      GO TO 840
  761 CALL WZERR(35)
      IF(IENMN-13) 840,3800,840
 2060 CALL WZERR(4)
      GO TO 840
 2070 CALL WZERR(7)
      GO TO 840
 2105 CALL WZERR(17)
      GO TO 855
 3470 CALL WZERR(23)
      GO TO 6200
 3305 CALL WZERR(26)
      GO TO 6800
 5510 CALL WZERR(12)
      GO TO 840
 3860 CALL WZERR(19)
      GO TO 3870
 6205 CALL WZERR(14)
      GO TO 6800
 3405 CALL WZERR(6)
      GO TO 6505
 6805 CALL WZERR(17)
      GO TO 6900
 5102 CALL WZERR(27)
      GO TO 840
      END

UNREFERENCED STATEMENTS
 208     776     3460

FEATURES SUPPORTED
 ONE WORD INTEGERS
 IOCS

CORE REQUIREMENTS FOR
 COMMON   3134  VARIABLES    174  PROGRAM   1720

END OF COMPILATION

// DUP
